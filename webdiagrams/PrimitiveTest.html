<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Primitive Test</title>
    <script src="look-and-feel.js"></script>
    <script src="primitives.js"></script>
    <script src="svg.js"></script>

    <style>

        #svg {
            border: 1px solid #000;
        }

    </style>
</head>
<body>

    <svg id="svg" width="640" height="480"></svg>

    <script>

        function randomText()
        {
            var text = "";
            var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

            for( var i=0; i < 1+Math.random()*100; i++ )
                text += possible.charAt(Math.floor(Math.random() * possible.length));

            return text;
        }

        var rect;
        var text;
       // var circle;
        var vgroup;

        (function(){
            let svgArea = new SVGArea("#svg");
         //   circle = svgArea.circle(50, 50, 20);
            //var ellipse = svgArea.ellipse(150, 150, 50, 25);
            //rect = svgArea.rect(10, 10, 100, 50);
            //text = svgArea.text(50, 50, "Test text");

            rect = svgArea.rect()
            vgroup = svgArea.vgroup(10, 10);
            vgroup.frame = rect;

            vgroup.addChild(svgArea.text(undefined, undefined, "Cliente"));
            vgroup.addChild(svgArea.line(), VerticalGroup.MATCH_PARENT);
            vgroup.addChild(svgArea.text(undefined, undefined, "- cpf: String"));
            vgroup.addChild(svgArea.text(undefined, undefined, "- nome: String"));
            vgroup.addChild(svgArea.text(undefined, undefined, "- dataNascimento: Date"));
            vgroup.addChild(svgArea.line(), VerticalGroup.MATCH_PARENT);
            vgroup.addChild(svgArea.text(undefined, undefined, "+ salvar(): void"));
            vgroup.addChild(svgArea.text(undefined, undefined, "+ atualizar(): void"));
            text = svgArea.text(undefined, undefined, "+ consultarPorCpf(cpf: String): List<Cliente>");
            vgroup.addChild(text);

            //var circle = svgArea.circle(50, 50, 50);
            //var contentBox = circle.contentBox;
            //console.log("(" + contentBox.x1 + "," + contentBox.y1 + ") a (" + contentBox.x2 + "," + contentBox.y2 + ")");
            //var rect = svgArea.rect(17.7, 17.7, 82.2, 82.2);

          //  var line = svgArea.line(20, 20, 100, 50);
        })();

        function changeDimensions() {
           if(vgroup.width > 400) {
               vgroup.width -= 50;
           } else {
               vgroup.width += 10;
           }
        }

        function move() {
            if(vgroup.x > 200) {
                vgroup.x -= 50;
            } else {
                vgroup.x += 10;
            }
        }

        // TODO: correct - style not changing
        function changeStyle() {
            rect.appearance({
                fill: "none",
                stroke: "red",
                strokeWidth: 2});
        }

        // TODO: correct - change group width when a child element is changed.
        function changeText() {
            text.text = randomText();
        }

    </script>

    <button type="button" onclick="changeDimensions()">Change dimensions</button>
    <button type="button" onclick="move()">Move</button>
    <button type="button" onclick="changeStyle()">Change style</button>
    <button type="button" onclick="changeText()">Change text</button>

</body>
</html>